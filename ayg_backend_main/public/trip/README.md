# Airport Sherpa API Usage Guide

## Flight Status

### Keys

> See root README.MD


## Overview

Flight Statuses are being pulled from FlightStats and has a big library of functions. This implementation is limited to just the Airport Sherpa usage. The API calls two separate FlightStats APIs depending on the data of the flight. The full API documentation can be found at:

------------------

### Trip List

Get list of trips a user has created manually and imported from TripIt. Note: Trips that end (+1 hour after last flight arrival) are not shown in the list.

> /list/a/:a/e/:e/u/:u/refresh/:refresh

An array will be returned with each entry having the following elements representing one trip.

##### Parameters

1. Standard API Auth parameters (a, e, u)
2. *refresh*
	* 1 or 0; you should use 0 by default, but when the user pulls down the list, it should mean force refresh, hence use value of 1. Forcing refresh will also attempt to pull new Trips from TripIt.

##### JSON Response Parameters

1. *tripId*
	* Trip's unique Id
2. *tripName*
	* Name of the trip; auto generated when the first flight is added
3. *firstFlightDepartureTimestamp*
	* Timestamp of the departure of the first flight in the list; you should order by this field to show the earliest to latest trip in the list
4. *firstFlightDepartureTimezone*
	* Timezone of the first flight in the trip
5. *firstFlightDepartureTimezoneShort*
	* Short Timezone of the first flight in the trip
6. *firstFlightDepartureAirportIataCode*
	* Airoirt IATA code of the first flight in the trip
7. *lastFlightArrivalTimestamp*
	* Timestamp of the arrival of the last flight in the list
8. *lastFlightArrivalTimezone*
	* Timezone of the last flight in the trip
9. *lastFlightArrivalTimezoneShort*
	* Timezone Short of the last flight in the trip
10. *lastFlightArrivalAirportIataCode*
	* Airoirt IATA code of the last flight in the trip
11. *isFromTripIt*
	* true/false indicates if this trip was imported from TripIt


------------------

### Trip Details

Get flights under a given tripId

> /a/:a/e/:e/u/:u/tripId/:tripId

An array will be returned with each entry having the following elements representing one trip.

##### Parameters

1. Standard API Auth parameters (a, e, u)
2. *flightId*
	* Unique Id from /flight/search

##### JSON Response Parameters

* This response array will be similar to /flight/flightId/:flightId, however, there will be multiple sub-arrays representing one flight.

------------------

### Search flights

*With flight id*
> /flight/search/a/:a/e/:e/u/:u/airlineIataCode/:airlineIataCode/flightNum/:flightNum/flightYear/:flightYear/flightMonth/:flightMonth/flightDate/:flightDate

##### Parameters

1. Standard API Auth parameters (apikey, epoch, session)
2. *airlineIataCode*
	* Airline Code are items such as, AA, SWA. *Note:* This have to match the Airline codes in the Parse Airline class.
3. *flightNum*
	* Flight Number is the numeric part (e.g. 4382, 0212)
4. *flightYear*
	* Flight Year is the 4 digit year
5. *flightMonth*
	* Flight Month is the 2 digit month
6. *flightDate*
	* Flight Date is the 1 or 2 digit day of month e.g. 1, 2, 12, 14


*With to and from airports*
> /flight/search/a/:a/e/:e/u/:u/airlineIataCode/:airlineIataCode/fromAirportIataCode/:fromAirportIataCode/toAirportIataCode/:toAirportIataCode/flightYear/:flightYear/flightMonth/:flightMonth/flightDate/:flightDate

This API returns list of flights that match the provided input. For flights outside -7 to +3 day window from the time of departure will have fewer values as indicated below. 

*Note*: the max date for this API response is 365 days from the current date

##### Parameters

1. Standard API Auth parameters (apikey, epoch, session)
2. *airlineIataCode*
	* Airline Code are items such as, AA, SWA. *Note:* This have to match the Airline codes in the Parse Airline class.
3. *fromAirportIataCode*
	* From airport's IATA code
4. *toAirportIataCode*
	* To airport's IATA code
5. *flightYear*
	* Flight Year is the 4 digit year
6. *flightMonth*
	* Flight Month is the 2 digit month
7. *flightDate*
	* Flight Date is the 1 or 2 digit day of month e.g. 1, 2, 12, 14

##### JSON Response Parameters

An array will be returned with each entry having the following elements representing one flight. If more than one element is responded with these attributes, then it means there are more than one flight that have the same Flight Number for the given date. At this point you must show the view to the user to select one of the multiple flights. For subsequent flight updates, you must save Flight Id and then use the Flight Id version of this call to get status updates.

1. *info*
	1. *uniqueId*
		* Unique Flight Identifier generated by rest of the APIs; used as flightId for all subsquent calls
	2. *airlineCode*
		* Airline Code. This should match the code sent in the request
	3. *airlineName*
		* Airline Name.
	4. *flightNum*
		* Flight Number. This should match the code sent in the request
	5. *statusDescription*
		* Status to display to user
	6. *statusInterpreted*
		* Status code:
			* D - Status unknown - Diverted
			* DN - Status unknown - Data source needed
			* NO - Status unknown - Not Operational
			* R - Status unknown - Redirected
			* U - Status unknown - Unknown
			* A - In air - Active
			* C - Cancelled
			* L - Arrived
			* S - Scheduled
			* _S_TDY_ - On time - Scheduled status on the same day of travel
			* _S_DLY_ - Delayed
			* _L_DLY_ - Landed (late)
			* _L_ELY_ - Landed (early)
	7. *hasAlreadyDeparted*
		* true/false - for flights already departed, app shouldn't the flight to be added (/add will raise an error if you do)
2. *departure*
	1. *airportIataCode*
		* Airport Iata Code
	2. *airportTimezone*
		* Timezone for airport
	3. *airportTimezoneShort*
		* Timezone for airport short, e.g. EST
	4. *airportName*
		* Airport Name
	5. *airportCity*
		* Airport City
	6. *airportCountry*
		* Airport Country
	7. *airportIsReady*
		* true/false identifies if the airport is Airport Sherpa ready
	8. *flightDate*
		* Scheduled Departure Date, e.g. Jan-9-2017 (local airport time)
	9. *flightTime*
		* Scheduled Departure Flight time, e.g. 2:15 PM (local airport time)
	10. *delayMinutes*
		* Any known delays in minutes
	11. *earlyMinutes*
		* Any known early departure in minutes
	12. *lastKnownTimestamp*
		* Timestamp of updated departure time
	14. *lastKnownTimestampFormatted*
		* Formatted Timestamp of updated departure time
3. *arrival*
	1. *airportIataCode*
		* Airport Iata Code
	2. *airportTimezone*
		* Timezone for airport
	3. *airportTimezoneShort*
		* Timezone for airport short, e.g. EST
	4. *airportName*
		* Airport Name
	5. *airportCity*
		* Airport City
	6. *airportCountry*
		* Airport Country
	7. *airportIsReady*
		* true/false identifies if the airport is Airport Sherpa ready
	8. *flightDate*
		* Arrivl Date, e.g. Jan-9-2017 (local airport time)
	9. *flightTime*
		* Scheduled Arrival Flight time, e.g. 2:15 PM (local airport time)
	10. *delayMinutes*
		* Any known delays in minutes
	11. *earlyMinutes*
		* Any known early arrival in minutes
	12. *lastKnownTimestamp*
		* Timestamp of updated arrival time
	14. *lastKnownTimestampFormatted*
		* Formatted Timestamp of updated arrival time


------------------

### Add flight

Add flight to user's account

> flight/add/a/:apikey/e/:epoch/u/:sessionToken/flightId/:flightId

This API returns a trip id to which the flight was added.

##### Parameters

1. Standard API Auth parameters (apikey, epoch, parseuserid)
2. *flightId*
	* Unique Id from /flight/search

##### JSON Response Parameters

1. *tripId*
	* Trip to which flight was added


------------------

### Flight Information with Status 

Get Flight information along with update status

> /flight/a/:apikey/e/:epoch/u/:sessionToken/flightId/:flightId

An array will be returned with each entry having the following elements representing one flight.

##### Parameters

1. Standard API Auth parameters (a, e, u)
2. *flightId*
	* Unique Id from /flight/search

##### JSON Response Parameters

1. *info*
	1. *uniqueId*
		* Unique Flight Identifier generated by rest of the APIs
	2. *airlineCode*
		* Airline Code. This should match the code sent in the request
	3. *airlineName*
		* Airline Name.
	4. *flightNum*
		* Flight Number. This should match the code sent in the request
	5. *statusInterpreted*
		* Status code:
			* D - Status unknown - Diverted
			* DN - Status unknown - Data source needed
			* NO - Status unknown - Not Operational
			* R - Status unknown - Redirected
			* U - Status unknown - Unknown
			* A - In air - Active
			* C - Cancelled
			* L - Arrived
			* S - Scheduled
			* _S_TDY_ - On time - Scheduled status on the same day of travel
			* _S_DLY_ - Delayed
			* _L_DLY_ - Landed (late)
			* _L_ELY_ - Landed (early)
	6. *statusDescription*
		* Status to display to user
	7. *scheduledAirMinutes*
		* Number of in Air minutes as per the schedule
		* *Not available outside date range*
	8. *scheduledBlockMinutes*
		* This is usually same as scheduledAirMinutes, but list 
		* *Not available outside date range*

2. *departure*
	1. *airportIataCode*
		* Airport Iata Code
	2. *airportTimezone*
		* Timezone for airport
	3. *airportTimezoneShort*
		* Timezone for airport short, e.g. EST
	4. *airportName*
		* Airport Name
	5. *airportCity*
		* Airport City
	6. *airportCountry*
		* Airport Country
	7. *airportIsReady*
		* true/false identifies if the airport is Airport Sherpa ready
	8. *flightDate*
		* Scheduled Departure Date, e.g. Jan-9-2017 (local airport time)
	9. *flightTime*
		* Scheduled Departure Flight time, e.g. 2:15 PM (local airport time)
	10. *scheduledGateTimestamp*
		* Original scheduled timestamp
	11. *lastKnownTimestamp*
		* Last known departure UNIX timestamp (includes updated delays); must be formatted using Airport Timezone provided above
	12. *location*
		* If airportIsReady = true, and the departure gate information was identifiable / provided, then this would represent the location Id from TerminalGateMap, else look at the next arrtibute
	13. *locationExt*
		* If location field is not provided, then this will be filled, with three indexes:
			*terminalConcourse*
				* Terminal & Concourse combined
			*gate*
				* Gate
	14. *isGateInfoEstimated*
		* true/false - indicates if the gate information is estimated based on history or pulled from currently list values
	15. *delayMinutes*
		* Any known departure delays in minutes
	16. *earlyMinutes*
		* Listed if the flight left early; in minutes
	17. *boardingTimestamp*
		* UNIX timestamp (this is not provided by airline so is only estimated); must be formatted using Airport timezone
	18. *lastKnownTimestampFormatted*
		* Formatted Timestamp of updated departure time

3. *arrival*
	1. *airportIataCode*
		* Airport Iata Code
	2. *airportTimezone*
		* Timezone for airport
	3. *airportTimezoneShort*
		* Timezone for airport short, e.g. EST
	4. *airportName*
		* Airport Name
	5. *airportCity*
		* Airport City
	6. *airportCountry*
		* Airport Country
	7. *airportIsReady*
		* true/false identifies if the airport is Airport Sherpa ready
	8. *flightDate*
		* Arrivl Date, e.g. Jan-9-2017 (local airport time)
	9. *flightTime*
		* Scheduled Arrival Flight time, e.g. 2:15 PM (local airport time)
	10. *baggage*
		* Baggage Claim carousel number; not always available
	11. *scheduledGateTimestamp*
		* Original scheduled timestamp
	12. *lastKnownTimestamp*
		* Last known arrival UNIX timestamp (includes known delays); must be formatted using Airport Timezone provided above
	13. *location*
		* If airportIsReady = true, and the arrival gate information was identifiable / provided, then this would represent the location Id from TerminalGateMap, else look at the next arrtibute
	14. *locationExt*
		* If location field is not provided, then this will be filled, with three indexes:
			*terminalConcourse*
				* Terminal & Concourse combined
			*gate*
				* Gate
	15. *isGateInfoEstimated*
		* true/false - indicates if the gate information is estimated based on history or pulled from currently list values
	16. *delayMinutes*
		* Any known arrival delays in minutes
	17. *earlyMinutes*
		* Listed if the flight arrival early; in minutes
	18. *lastKnownTimestampFormatted*
		* Formatted Timestamp of updated arrival time

------------------

### Next Trip and Flight

Get the Ids of the next trip and flight as per the last known departure timestamps

> next/a/:a/e/:e/u/:u

An empty response means, no next flight or trip available

##### Parameters

1. Standard API Auth parameters (a, e, u)

##### JSON Response Parameters

1. *tripId*
	* Next trip's unique Id; it may be the same as of the current one if there are more than one flight in the trip and nextFlightId is representing the next flight in the trip
2. *nextFlightId*
	* Next flight id


------------------

### Trip - Delete

Deletes the trip and associated flights underneath it. This will NOT delete a TripIt trip. Hence you should disallow that call locally by showing a message.

> /delete/a/:a/e/:e/u/:u/tripId/:tripId

##### Parameters

1. Standard API Auth parameters (a, e, u)
2. *tripId*
	* Trip Id to delete

##### JSON Response Parameters

1. *deleted*
	* true/false

------------------

### Flight - Delete

Deletes the flight. It will also delete the trip if this is the only flight in it. This will NOT delete a TripIt flight. Hence you should disallow that call locally by showing a message.

> /flight/delete/a/:a/e/:e/u/:u/flightId/:flightId

##### Parameters

1. Standard API Auth parameters (a, e, u)
2. *flightId*
	* Flight Id to delete

##### JSON Response Parameters

1. *deleted*
	* true/false

